let passport,User,config;_0e9‍.x([["default",()=>_0e9‍.o]]);_0e9‍.w("passport",[["default",["passport"],function(v){passport=v}]]);_0e9‍.w("../models/user_Auth",[["default",["User"],function(v){User=v}]]);_0e9‍.w("./config",[["default",["config"],function(v){config=v}]]);



const JwtStrategy = require('passport-jwt').Strategy;
const ExtractJwt = require('passport-jwt').ExtractJwt;

const opts = {};

opts.jwtFromRequest = ExtractJwt.fromAuthHeaderAsBearerToken();
opts.secretOrKey = config.secretOrKey;

passport.use(new JwtStrategy(opts, (jwt_payload, done) => {
	User.findById(jwt_payload.id)
		.then(user => {
			if (user) {
				return done(null, user);
			}
			return done(null, false);
		});
})
);

_0e9‍.d(passport);